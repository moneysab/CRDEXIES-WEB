<div class="container-fluid px-4">
    <div class="card mc-card p-3">
      <div class="card-header bg-white d-flex justify-content-between align-items-center border-0">
        <h4 class="mc-title mb-0">
          <i class="ti ti-alert-triangle me-2 text-warning"></i>{{ 'DETAILS.TITLE.MASTERCARD' | translate }}
        </h4>
        <button class="btn btn-outline-warning" (click)="goBack()">
          <i class="ti ti-arrow-left"></i> {{ 'DETAILS.BACK' | translate }}
        </button>
      </div>
  
      <div class="card-body pt-0">
        <div *ngIf="errorMessage" class="alert alert-danger mt-3">{{ errorMessage }}</div>
  
        <div *ngIf="isLoading" class="d-flex justify-content-center py-4">
          <div class="spinner-border text-warning" role="status">
            <span class="visually-hidden">{{ 'DETAILS.LOADING' | translate }}</span>
          </div>
        </div>
  
        <div *ngIf="!isLoading && anomaly" class="anomaly-details mt-3">
          <h5 class="section-title">{{ 'DETAILS.ANOMALY_INFO' | translate }}</h5>
          <div class="info-card row">
            <div class="col-md-6 info-item"><strong>{{ 'DETAILS.DESCRIPTION' | translate }}:</strong> {{ anomaly.description }}</div>
            <div class="col-md-6 info-item"><strong>{{ 'DETAILS.CATEGORY' | translate }}:</strong> {{ anomaly.category }}</div>
            <div class="col-md-6 info-item"><strong>{{ 'DETAILS.SEVERITY' | translate }}: </strong>
              <span [ngClass]="{
                'text-danger': anomaly.severity === 'HIGH',
                'text-warning': anomaly.severity === 'MEDIUM',
                'text-success': anomaly.severity === 'LOW'
              }">{{ anomaly.severity }}</span>
            </div>
  
            <div class="col-md-6 info-item"><strong>{{ 'DETAILS.DEVIATION' | translate }}:</strong>
              <span [ngClass]="getGrowthClass(anomaly.deviationPercentage)">
                <i class="ti ti-trending-{{ getGrowthIcon(anomaly.deviationPercentage) }}"></i>
                {{ anomaly.deviationPercentage }}%
              </span>
            </div>
  
            <div class="col-md-6 info-item"><strong>{{ 'DETAILS.EXPECTED' | translate }}:</strong> {{ formatCurrency(anomaly.expectedValue) }}</div>
            <div class="col-md-6 info-item"><strong>{{ 'DETAILS.ACTUAL' | translate }}:</strong> {{ formatCurrency(anomaly.actualValue) }}</div>
            <div class="col-md-6 info-item"><strong>{{ 'DETAILS.DETECTION_DATE' | translate }}:</strong>  {{ formatDate(anomaly.detectionDate) }}</div>
          </div>
  
          <div *ngIf="invoice" class="invoice-details mt-4">
            <h5 class="section-title">{{ 'DETAILS.INVOICE_INFO' | translate }}</h5>
            <div class="info-card row">
              <div class="col-md-6 info-item"><strong>Document Type:</strong> {{ invoice.documentType || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Invoice Number:</strong> {{ invoice.invoiceNumber || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Currency:</strong> {{ invoice.currency || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Billing Cycle Date:</strong> {{ formatDate(invoice.billingCycleDate) }}</div>
              <div class="col-md-6 info-item"><strong>Invoice ICA:</strong> {{ invoice.invoiceIca || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Activity ICA:</strong> {{ invoice.activityIca || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Billable ICA:</strong> {{ invoice.billableIca || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Service Code:</strong> {{ invoice.serviceCode || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Service Description:</strong> {{ invoice.serviceCodeDescription || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Event ID:</strong> {{ invoice.eventId || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Event Description:</strong> {{ invoice.eventDescription || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Affiliate:</strong> {{ invoice.affiliate || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Total Charge:</strong> {{ formatCurrency(invoice.totalCharge, invoice.currency) }}</div>
              <div class="col-md-6 info-item"><strong>Fee Type:</strong> {{ invoice.feeType || '–' }}</div>
              <div class="col-md-6 info-item"><strong>Category:</strong> {{ invoice.category || '–' }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  